class CPU:
    # í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤ì œë¡œ ì‹¤í–‰í•˜ëŠ” í•˜ë“œì›¨ì–´ ìœ ë‹›
    # í•œ ë²ˆì— í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ë§Œ ì‹¤í–‰í•  ìˆ˜ ìˆìŒ
    
    def __init__(self):
        # í˜„ì¬ CPUë¥¼ ì ìœ í•˜ê³  ìˆëŠ” í”„ë¡œì„¸ìŠ¤ (ì—†ìœ¼ë©´ None)
        self.current_process = None 
        
        # CPU ë‚´ë¶€ ì‹œê³„ (ì´ ì‹¤í–‰ëœ í‹± ìˆ˜)
        self.time = 0 

    # CPUê°€ í˜„ì¬ ì¼í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜. 
    def is_busy(self):
        # current_process(í˜„ì¬ CPUìœ„ì— ì˜¬ë ¤ì ¸ ìˆëŠ” í”„ë¡œì„¸ìŠ¤)ê°€ ìˆìœ¼ë©´ True, ì—†ìœ¼ë©´ False ë°˜í™˜
        return self.current_process is not None

    # ë¬¸ë§¥ êµí™˜ì„ ìˆ˜í–‰í•˜ëŠ” ë©”ì„œë“œ. ì‰½ê²Œ ë§í•´, CPU ìœ„ì— ê¸°ì¡´ì˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ë‚´ë¦¬ê³  ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¥¼ ì˜¬ë¦¬ëŠ” ì‘ì—…ì„ í•˜ëŠ” í•¨ìˆ˜
    def load_process(self, process):

        # ë§Œì•½ ì§€ê¸ˆ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ê°€ ìˆë‹¤ë©´ ì«“ì•„ë‚´ì•¼ í•¨
        if self.current_process:
            
            # prev_pid ë³€ìˆ˜ê°€ ê¸°ì¡´ í”„ë¡œì„¸ìŠ¤ì˜ PIDë¥¼ ì €ì¥. 
            prev_pid = self.current_process.pid
            # ì›ë˜ëŠ” ì—¬ê¸°ì„œ ë ˆì§€ìŠ¤í„° ì €ì¥ ë¡œì§ì´ ë“¤ì–´ê°€ì•¼ í•˜ì§€ë§Œ
            # ê°ì²´ ìì²´ê°€ PCBì´ë¯€ë¡œ ìë™ìœ¼ë¡œ ì €ì¥ëœ ìƒíƒœë¼ê³  ìƒê°. ì‰½ê²Œ ë§í•´, self.current_process ê°ì²´ê°€ ì´ë¯¸ ë ˆì§€ìŠ¤í„° ê°’ì„ ê°€ì§€ê³  ìˆìŒ
        
        # ë§Œì•½ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ê°€ ì—†ë‹¤ë©´ ê·¸ëƒ¥ None ì²˜ë¦¬. íƒœ
        else:
            prev_pid = "None" 

        # ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¥¼ CPUì— ì˜¬ë¦¼ 
        self.current_process = process
        
        # ë¬¸ë§¥ êµí™˜ ë¡œê·¸ ì¶œë ¥. ì•„ë¬´ê²ƒë„ ëª»í•˜ëŠ” ì˜¤ë²„í—¤ë“œ ìƒíƒœê°€ ë°œìƒí•˜ëŠ” ì§€ì 
        print(f"   ğŸ’¾ [Switch] Context Change: PID {prev_pid} -> PID {process.pid}")

    
    # CPUë¥¼ 1 í‹± ì‹¤í–‰í•˜ëŠ” ë©”ì„œë“œ
    def run(self):
        # ì‹¤í–‰í•  í”„ë¡œì„¸ìŠ¤ê°€ ì—†ìœ¼ë©´ ì•„ë¬´ê²ƒë„ ì•ˆ í•¨ (Idle ìƒíƒœ)
        if not self.current_process:
            return

        # í”„ë¡œì„¸ìŠ¤ì—ê²Œ 1í‹±ë™ì•ˆ ì‹¤í–‰í•˜ë¼ê³  ì§€ì‹œ
        self.current_process.tick()
        
        # CPU ì‹œê°„ë„ íë¦„
        self.time += 1
        
        # ë¡œê·¸ ì¶œë ¥ (ë„ˆë¬´ ìì£¼ ì°íˆë©´ ì‹œë„ëŸ¬ìš°ë‹ˆ í•„ìš”í•  ë•Œë§Œ ì£¼ì„ í•´ì œ)
        # print(f" [CPU] PID {self.current_process.pid} ì‹¤í–‰ ì¤‘... (PC: {self.current_process.registers['PC']})")